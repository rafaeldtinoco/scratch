# sudo fence_aws -n i-034dc89cca4310b03 -o reboot -r us-east-1 -a AKIA4HWEZZQ5RHQASP7E -s "BvJNDN+/hye5M0PsGonF2xFCbUNFWX7WJVbb2tJs" -v

primitive fence-focal01 stonith:fence_aws \
params access_key="AKIA4HWEZZQ5RHQASP7E" \
secret_key="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" \
region="us-east-1" plug="i-034dc89cca4310b03" \
pcmk_host_map="focal01:i-034dc89cca4310b03;focal02:i-0a160b14b40f1330a;focal03:i-03b6976ab0a7f377c"

primitive fence-focal02 stonith:fence_aws \
params access_key="AKIA4HWEZZQ5RHQASP7E" \
secret_key="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" \
region="us-east-1" plug="i-0a160b14b40f1330a" \
pcmk_host_map="focal01:i-034dc89cca4310b03;focal02:i-0a160b14b40f1330a;focal03:i-03b6976ab0a7f377c"

primitive fence-focal03 stonith:fence_aws \
params access_key="AKIA4HWEZZQ5RHQASP7E" \
secret_key="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" \
region="us-east-1" plug="i-03b6976ab0a7f377c" \
pcmk_host_map="focal01:i-034dc89cca4310b03;focal02:i-0a160b14b40f1330a;focal03:i-03b6976ab0a7f377c"

location l-fence-focal01 fence-focal01 -inf: focal01
location l-fence-focal02 fence-focal02 -inf: focal02
location l-fence-focal03 fence-focal03 -inf: focal03

----

[rafaeldtinoco@focal01 ~]$ crm status
Cluster Summary:
  * Stack: corosync
  * Current DC: focal02 (version 2.0.3-4b1f869f0f) - partition with quorum
  * Last updated: Fri Oct 16 00:42:03 2020
  * Last change:  Fri Oct 16 00:41:44 2020 by root via cibadmin on focal01
  * 3 nodes configured
  * 3 resource instances configured

Node List:
  * Online: [ focal01 focal02 focal03 ]

Full List of Resources:
  * fence-focal01	(stonith:fence_aws):	 Started focal02
  * fence-focal02	(stonith:fence_aws):	 Started focal01
  * fence-focal03	(stonith:fence_aws):	 Started focal01

[rafaeldtinoco@focal01 ~]$ crm status
Cluster Summary:
  * Stack: corosync
  * Current DC: focal01 (version 2.0.3-4b1f869f0f) - partition with quorum
  * Last updated: Fri Oct 16 00:42:19 2020
  * Last change:  Fri Oct 16 00:41:44 2020 by root via cibadmin on focal01
  * 3 nodes configured
  * 3 resource instances configured

Node List:
  * Node focal02: UNCLEAN (offline)
  * Online: [ focal01 focal03 ]

Full List of Resources:
  * fence-focal01	(stonith:fence_aws):	 Started [ focal02 focal03 ]
  * fence-focal02	(stonith:fence_aws):	 Started focal01
  * fence-focal03	(stonith:fence_aws):	 Started focal01

Pending Fencing Actions:
  * reboot of focal02 pending: client=pacemaker-controld.1037, origin=focal01

[rafaeldtinoco@focal01 ~]$ crm status
Cluster Summary:
  * Stack: corosync
  * Current DC: focal01 (version 2.0.3-4b1f869f0f) - partition with quorum
  * Last updated: Fri Oct 16 01:34:50 2020
  * Last change:  Fri Oct 16 00:41:44 2020 by root via cibadmin on focal01
  * 3 nodes configured
  * 3 resource instances configured

Node List:
  * Online: [ focal01 focal02 focal03 ]

Full List of Resources:
  * fence-focal01	(stonith:fence_aws):	 Started focal03
  * fence-focal02	(stonith:fence_aws):	 Started focal01
  * fence-focal03	(stonith:fence_aws):	 Started focal02

----

sudo fence_aws -n i-0136eddd045ceb7e2 -o reboot -r us-east-1 -a AKIA4HWEZZQ5RHQASP7E -s "BvJNDN+/hye5M0PsGonF2xFCbUNFWX7WJVbb2tJs" -v

primitive fence-bionic01 stonith:fence_aws \
params access_key="AKIA4HWEZZQ5RHQASP7E" \
secret_key="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" \
region="us-east-1" plug="i-068e134de1beddc7f" \
pcmk_host_map="bionic01:i-068e134de1beddc7f;bionic02:i-0136eddd045ceb7e2;bionic03:i-0de279ab4e6d642c8"

primitive fence-bionic02 stonith:fence_aws \
params access_key="AKIA4HWEZZQ5RHQASP7E" \
secret_key="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" \
region="us-east-1" plug="i-0136eddd045ceb7e2" \
pcmk_host_map="bionic01:i-068e134de1beddc7f;bionic02:i-0136eddd045ceb7e2;bionic03:i-0de279ab4e6d642c8"

primitive fence-bionic03 stonith:fence_aws \
params access_key="AKIA4HWEZZQ5RHQASP7E" \
secret_key="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" \
region="us-east-1" plug="i-0de279ab4e6d642c8" \
pcmk_host_map="bionic01:i-068e134de1beddc7f;bionic02:i-0136eddd045ceb7e2;bionic03:i-0de279ab4e6d642c8"

location l-fence-bionic01 fence-bionic01 -inf: bionic01
location l-fence-bionic02 fence-bionic02 -inf: bionic02
location l-fence-bionic03 fence-bionic03 -inf: bionic03

----

primitive fence-bionic01 stonith:fence_aws \
    params access_key=AKIA4HWEZZQ5RHQASP7E \
    secret_key="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" \
    region=us-east-1 \
    plug=i-068e134de1beddc7f \
    pcmk_host_list="bionic01;bionic02;bionic03" \
    pcmk_host_check="static-list" \
    pcmk_host_map="bionic01:i-068e134de1beddc7f;bionic02:i-0136eddd045ceb7e2;bionic03:i-0de279ab4e6d642c8"

primitive fence-bionic02 stonith:fence_aws \
    params access_key=AKIA4HWEZZQ5RHQASP7E \
    secret_key="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" \
    region=us-east-1 \
    plug=i-0136eddd045ceb7e2 \
    pcmk_host_list="bionic01;bionic02;bionic03" \
    pcmk_host_check="static-list" \
    pcmk_host_map="bionic01:i-068e134de1beddc7f;bionic02:i-0136eddd045ceb7e2;bionic03:i-0de279ab4e6d642c8"

primitive fence-bionic03 stonith:fence_aws \
    params access_key=AKIA4HWEZZQ5RHQASP7E \
    secret_key="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" \
    region=us-east-1 \
    plug=i-0de279ab4e6d642c8 \
    pcmk_host_list="bionic01;bionic02;bionic03" \
    pcmk_host_check="static-list" \
    pcmk_host_map="bionic01:i-068e134de1beddc7f;bionic02:i-0136eddd045ceb7e2;bionic03:i-0de279ab4e6d642c8"

location l-fence-bionic01 fence-bionic01 -inf: bionic01
location l-fence-bionic02 fence-bionic02 -inf: bionic02
location l-fence-bionic03 fence-bionic03 -inf: bionic03


